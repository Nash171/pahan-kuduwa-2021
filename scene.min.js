const canvas=document.getElementById("renderCanvas");const engine=new BABYLON.Engine(canvas,true);const main_lanterns=[];const all_lanterns=[];const all_meshes=[];const frameRate=60;const createScene=function(){const r=new BABYLON.Scene(engine);r.clearColor=BABYLON.Color3.Black();r.collisionsEnabled=true;const e=new BABYLON.UniversalCamera("UniversalCamera",new BABYLON.Vector3(0,40,600),r);e.setTarget(new BABYLON.Vector3(0,200,0));e.inputs.addMouseWheel();e.attachControl(canvas,true);e.checkCollisions=true;const l=new BABYLON.MeshBuilder.CreateCylinder("container",{height:500,diameter:1500,sideOrientation:1},r);l.position.y=250;l.checkCollisions=true;const t=createLantern(r,"Lantern1",{r1:8,r2:64,h1:8,h2:8,speed:0,order:0},"Lantern-1");main_lanterns.push(t);const o=createLantern(r,"Lantern2",{r1:8,r2:32,h1:8,h2:8,speed:1,order:1},"Lantern-2");main_lanterns.push(o);const u=createLantern(r,"Lantern3",{r1:8,r2:8,h1:0,h2:10,speed:-1,order:2},"Lantern-3-4-6-7");main_lanterns.push(u);const n={r1:8,r2:20,h1:12,h2:20,speed:1,order:3};const p=createLantern(r,"bottomGrp_main",n,"Grp-bottom-main");main_lanterns.push(p);createSubLanterns(r,p.outerLayer,"bottomGrp",2,n,6,"Grp",9);const a=createLantern(r,"Lantern4",{r1:8,r2:8,h1:0,h2:10,speed:1,order:3},"Lantern-3-4-6-7");main_lanterns.push(a);const w=createLantern(r,"Lantern5",{r1:8,r2:48,h1:8,h2:8,speed:-1,order:4},"Lantern-5");main_lanterns.push(w);const s=createLantern(r,"Lantern6",{r1:8,r2:8,h1:0,h2:10,speed:1,order:5},"Lantern-3-4-6-7");main_lanterns.push(s);const h={r1:8,r2:32,h1:16,h2:32,speed:-1,order:6};const i=createLantern(r,"topGrp_main",h,"Grp-top-main");main_lanterns.push(i);createSubLanterns(r,i.outerLayer,"topGrp",2,h,6,"Grp",11);const d=createLantern(r,"Lantern7",{r1:8,r2:8,h1:0,h2:10,speed:-1,order:6},"Lantern-3-4-6-7");main_lanterns.push(d);const c=createLantern(r,"Lantern8",{r1:8,r2:110,h1:8,h2:8,speed:1,order:7},"Lantern-8");main_lanterns.push(c);const g=createLantern(r,"Lantern9",{r1:8,r2:220,h1:0,h2:16,speed:1,order:8},"Lantern-9");main_lanterns.push(g);stackLanterns(main_lanterns);const b=new BABYLON.GlowLayer("glow",r);b.intensity=.8;for(let e=0;e<all_lanterns.length;e++){if(all_lanterns[e].options.speed!=0){r.beginDirectAnimation(all_lanterns[e].outerLayer,[rotateLantern(all_lanterns[e].options.speed)],0,60*frameRate,true)}}for(let e=0;e<all_meshes.length;e++){r.beginDirectAnimation(all_meshes[e].lightLayer,[changeColor(all_meshes[e])],0,130*frameRate,true);all_meshes[e].outerLayer.material.emissiveColor=new BABYLON.Color3(.02,.02,.02)}animateCamera(r,e);return r};const animateCamera=(e,r)=>{const l=new BABYLON.Animation("movein","position",frameRate,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT);const t=[];t.push({frame:0,value:r.position.clone()});t.push({frame:5*frameRate,value:r.position.clone()});t.push({frame:11*frameRate,value:new BABYLON.Vector3(0,40,150)});t.push({frame:13*frameRate,value:new BABYLON.Vector3(0,40,120)});t.push({frame:21*frameRate,value:new BABYLON.Vector3(0,40,320)});l.setKeys(t);const o=new BABYLON.Animation("rotate","rotation.x",frameRate,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT);const u=[];u.push({frame:0,value:-Math.PI/12});u.push({frame:5*frameRate,value:-Math.PI/12});u.push({frame:11*frameRate,value:-Math.PI/10});u.push({frame:13*frameRate,value:Math.PI/16});u.push({frame:21*frameRate,value:-Math.PI/4});u.push({frame:25*frameRate,value:-Math.PI/12});o.setKeys(u);e.beginDirectAnimation(r,[l,o],0,25*frameRate,false)};const createLantern=(e,r,l,t)=>{const o=new BABYLON.Mesh(r,e);const{r1:u,r2:n,h1:p,h2:a}=l;const w=6;const s=[u,n,n,u];const h=-(p+a+p)/2;const i=[h,h+p,h+p+a,h+p+a+p];const d=2*Math.PI/w;let c=[];for(let e=0;e<i.length;e++){const _=i[e];const I=s[e];for(let e=0;e<w;e++){c.push(I*Math.cos(e*d),_,I*Math.sin(e*d))}}let g=[];for(let e=0;e<3;e++){const x=e*w;for(let e=0;e<w;e++){g.push(x+e,x+(e+1)%w,x+e+w);g.push(x+(e+1)%w+w,x+e+w,x+(e+1)%w)}}const b=(n-u)/2;const m=Math.sqrt(p**2+3*(n-u)**2/4);const y=n;const f=m*2+a;const L=b/y;const B=(n-b)/y;const v=m/f;const A=(m+a)/f;const O=[L,0,B,0,L,0,B,0,L,0,B,0,0,v,1,v,0,v,1,v,0,v,1,v,0,A,1,A,0,A,1,A,0,A,1,A,L,1,B,1,L,1,B,1,L,1,B,1];const R=[];const N=new BABYLON.VertexData;BABYLON.VertexData.ComputeNormals(c,g,R);N.positions=c;N.indices=g;N.normals=R;N.uvs=O;N.applyToMesh(o);const Y=new BABYLON.StandardMaterial("outerMaterial",e);Y.diffuseTexture=new BABYLON.Texture(t?`./texture/${t}.png`:generateImage(r,y*10,f*10,b*10,(n-b)*10,m*10,(m+a)*10),e);Y.diffuseTexture.hasAlpha=true;o.material=Y;const C=new BABYLON.StandardMaterial("innerMaterial",e);C.emissiveColor=new BABYLON.Color3(.5,0,0);const M=o.clone(`${r}-lightLayer`);M.scaling=new BABYLON.Vector3(.995,.995,.995);M.material=C;M.parent=o;const T={outerLayer:o,options:l,lightLayer:M};all_lanterns.push(T);all_meshes.push(T);return T};const createSubLanterns=(r,l,t,o,u,n,p,a)=>{const w={r1:0,r2:u.r2/2,h1:u.h1/2,h2:u.h2/2,speed:u.speed*-3,order:a};const s=2*Math.PI/n;for(let e=0;e<n;e++){const h=`${t}-${e}`;const i=createLantern(r,h,{...w,suborder:e},`${p}-${o}`);i.outerLayer.parent=l;const d=o==1?w.r2*6:w.r2*8;i.outerLayer.position=new BABYLON.Vector3(d*Math.cos(e*s),0,d*Math.sin(e*s));const c=[new BABYLON.Vector3(0,u.r2,0),new BABYLON.Vector3(0,o>1?u.h1+u.h2/2+5:u.r2+1,0),new BABYLON.Vector3(d*Math.cos(e*s),w.r2+1,d*Math.sin(e*s)),new BABYLON.Vector3(d*Math.cos(e*s),w.r2-2,d*Math.sin(e*s))];const g=BABYLON.MeshBuilder.CreateTube(`${h}-tube`,{path:c,radius:o/2,tesselation:8,sideOrientation:BABYLON.Mesh.DOUBLESIDE},r);const b=new BABYLON.StandardMaterial("tubeMaterial",r);b.diffuseTexture=new BABYLON.Texture(`./texture/Tube.png`,r);b.diffuseTexture.hasAlpha=true;g.material=b;const m=new BABYLON.StandardMaterial("tubeInnerMaterial",r);m.emissiveColor=new BABYLON.Color3(.5,0,0);const y=BABYLON.MeshBuilder.CreateTube(`${h}-tube-lightLayer`,{path:c,radius:o/2-.1,sideOrientation:BABYLON.Mesh.DOUBLESIDE},r);y.material=m;y.parent=g;all_meshes.push({outerLayer:g,options:{order:a,suborder:e},lightLayer:y});g.parent=l;if(o-1){createSubLanterns(r,i.outerLayer,h,o-1,w,n,p,a+1)}}};const rotateLantern=e=>{const r=new BABYLON.Animation("rotateLantern","rotation.y",frameRate,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);const l=[];l.push({frame:0,value:0});l.push({frame:15*frameRate,value:e*Math.PI});l.push({frame:30*frameRate,value:e*2*Math.PI});r.setKeys(l);return r};const red=new BABYLON.Color3(.5,0,0);const yellow=new BABYLON.Color3(.5,.5,0);const green=new BABYLON.Color3(0,.5,0);const blue=new BABYLON.Color3(0,.2,.8);const purple=new BABYLON.Color3(.5,0,.8);const white=new BABYLON.Color3(.5,.5,.5);const black=new BABYLON.Color3(0,0,0);const switchingColors=[{sec:0,smooth:false,colors:[red,yellow,red,yellow,red,yellow,red,yellow,red,[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red]]},{sec:1,smooth:false,colors:[yellow,red,yellow,red,yellow,red,yellow,red,yellow,[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow]]},{sec:2,smooth:false,colors:[red,yellow,red,yellow,red,yellow,red,yellow,red,[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red]]},{sec:3,smooth:false,colors:[yellow,red,yellow,red,yellow,red,yellow,red,yellow,[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow]]},{sec:4,smooth:false,colors:[red,yellow,red,yellow,red,yellow,red,yellow,red,[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red]]},{sec:5,smooth:false,colors:[yellow,red,yellow,red,yellow,red,yellow,red,yellow,[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow]]},{sec:6,smooth:false,colors:[red,yellow,red,yellow,red,yellow,red,yellow,red,[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red]]},{sec:7,smooth:false,colors:[yellow,red,yellow,red,yellow,red,yellow,red,yellow,[yellow,yellow,yellow,yellow,yellow,yellow],[red,red,red,red,red,red],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow]]},{sec:8,smooth:false,colors:[green,blue,green,blue,green,blue,green,blue,green,[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green]]},{sec:9,smooth:false,colors:[blue,green,blue,green,blue,green,blue,green,blue,[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue]]},{sec:10,smooth:false,colors:[green,blue,green,blue,green,blue,green,blue,green,[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green]]},{sec:11,smooth:false,colors:[blue,green,blue,green,blue,green,blue,green,blue,[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue]]},{sec:12,smooth:false,colors:[green,blue,green,blue,green,blue,green,blue,green,[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green]]},{sec:13,smooth:false,colors:[blue,green,blue,green,blue,green,blue,green,blue,[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue]]},{sec:14,smooth:false,colors:[green,blue,green,blue,green,blue,green,blue,green,[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green]]},{sec:15,smooth:false,colors:[blue,green,blue,green,blue,green,blue,green,blue,[blue,blue,blue,blue,blue,blue],[green,green,green,green,green,green],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue]]},{sec:16,smooth:false,colors:[purple,white,purple,white,purple,white,purple,white,purple,[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple]]},{sec:17,smooth:false,colors:[white,purple,white,purple,white,purple,white,purple,white,[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white]]},{sec:18,smooth:false,colors:[purple,white,purple,white,purple,white,purple,white,purple,[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple]]},{sec:19,smooth:false,colors:[white,purple,white,purple,white,purple,white,purple,white,[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white]]},{sec:20,smooth:false,colors:[purple,white,purple,white,purple,white,purple,white,purple,[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple]]},{sec:21,smooth:false,colors:[white,purple,white,purple,white,purple,white,purple,white,[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white]]},{sec:22,smooth:false,colors:[purple,white,purple,white,purple,white,purple,white,purple,[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple]]},{sec:23,smooth:false,colors:[white,purple,white,purple,white,purple,white,purple,white,[white,white,white,white,white,white],[purple,purple,purple,purple,purple,purple],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white]]},{sec:24,smooth:false,colors:[red,red,red,red,red,red,red,red,red,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:25,smooth:false,colors:[yellow,yellow,yellow,yellow,yellow,yellow,yellow,yellow,yellow,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:26,smooth:false,colors:[green,green,green,green,green,green,green,green,green,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:27,smooth:false,colors:[blue,blue,blue,blue,blue,blue,blue,blue,blue,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:28,smooth:false,colors:[purple,purple,purple,purple,purple,purple,purple,purple,purple,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:29,smooth:false,colors:[white,white,white,white,white,white,white,white,white,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:30,smooth:true,colors:[red,red,red,red,red,red,red,red,red,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:31,smooth:true,colors:[yellow,yellow,yellow,yellow,yellow,yellow,yellow,yellow,yellow,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:32,smooth:true,colors:[green,green,green,green,green,green,green,green,green,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:33,smooth:true,colors:[blue,blue,blue,blue,blue,blue,blue,blue,blue,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:34,smooth:true,colors:[purple,purple,purple,purple,purple,purple,purple,purple,purple,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:35,smooth:true,colors:[white,white,white,white,white,white,white,white,white,[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white],[red,yellow,green,blue,purple,white]]},{sec:37,smooth:true,colors:[red,yellow,green,blue,purple,white,red,yellow,green,[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue]]},{sec:38,smooth:true,colors:[yellow,green,blue,purple,white,red,yellow,green,blue,[yellow,yellow,yellow,yellow,yellow,yellow],[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[purple,purple,purple,purple,purple,purple]]},{sec:39,smooth:true,colors:[green,blue,purple,white,red,yellow,green,blue,purple,[green,green,green,green,green,green],[blue,blue,blue,blue,blue,blue],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white]]},{sec:40,smooth:true,colors:[blue,purple,white,red,yellow,green,blue,purple,white,[blue,blue,blue,blue,blue,blue],[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[red,red,red,red,red,red]]},{sec:41,smooth:true,colors:[purple,white,red,yellow,green,blue,purple,white,red,[purple,purple,purple,purple,purple,purple],[white,white,white,white,white,white],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow]]},{sec:42,smooth:false,colors:[white,red,yellow,green,blue,purple,white,red,yellow,[white,white,white,white,white,white],[red,red,red,red,red,red],[yellow,yellow,yellow,yellow,yellow,yellow],[green,green,green,green,green,green]]}];const changeColor=l=>{const e=new BABYLON.Animation("rotateLantern","material.emissiveColor",frameRate,BABYLON.Animation.ANIMATIONTYPE_COLOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);const t=[];t.push({frame:0,value:red});t.push({frame:5*frameRate-1,value:red});t.push({frame:5*frameRate,value:yellow});t.push({frame:10*frameRate-1,value:yellow});t.push({frame:10*frameRate,value:green});t.push({frame:15*frameRate-1,value:green});t.push({frame:15*frameRate,value:blue});t.push({frame:20*frameRate-1,value:blue});t.push({frame:20*frameRate,value:purple});t.push({frame:25*frameRate-1,value:purple});t.push({frame:25*frameRate,value:white});t.push({frame:30*frameRate-1,value:white});t.push({frame:30*frameRate,value:red});t.push({frame:31*frameRate-1,value:red});t.push({frame:31*frameRate,value:yellow});t.push({frame:32*frameRate-1,value:yellow});t.push({frame:32*frameRate,value:green});t.push({frame:33*frameRate-1,value:green});t.push({frame:33*frameRate,value:blue});t.push({frame:34*frameRate-1,value:blue});t.push({frame:34*frameRate,value:purple});t.push({frame:35*frameRate-1,value:purple});t.push({frame:35*frameRate,value:white});t.push({frame:36*frameRate-1,value:white});t.push({frame:36*frameRate,value:red});t.push({frame:38*frameRate,value:yellow});t.push({frame:40*frameRate,value:green});t.push({frame:42*frameRate,value:blue});t.push({frame:44*frameRate,value:purple});t.push({frame:46*frameRate,value:white});t.push({frame:48*frameRate,value:black});const r=6;t.push({frame:(50+l.options.order/r)*frameRate-1,value:black});t.push({frame:(50+l.options.order/r)*frameRate,value:red});t.push({frame:54*frameRate-1,value:red});t.push({frame:54*frameRate,value:black});t.push({frame:(55+l.options.order/r)*frameRate-1,value:black});t.push({frame:(55+l.options.order/r)*frameRate,value:yellow});t.push({frame:59*frameRate-1,value:yellow});t.push({frame:59*frameRate,value:black});t.push({frame:(60+l.options.order/r)*frameRate-1,value:black});t.push({frame:(60+l.options.order/r)*frameRate,value:green});t.push({frame:64*frameRate-1,value:green});t.push({frame:64*frameRate,value:black});t.push({frame:(65+l.options.order/r)*frameRate-1,value:black});t.push({frame:(65+l.options.order/r)*frameRate,value:blue});t.push({frame:69*frameRate-1,value:blue});t.push({frame:69*frameRate,value:black});t.push({frame:(70+l.options.order/r)*frameRate-1,value:black});t.push({frame:(70+l.options.order/r)*frameRate,value:purple});t.push({frame:74*frameRate-1,value:purple});t.push({frame:74*frameRate,value:black});t.push({frame:(75+l.options.order/r)*frameRate-1,value:black});t.push({frame:(75+l.options.order/r)*frameRate,value:white});t.push({frame:(79+l.options.order/r)*frameRate-1,value:white});t.push({frame:(79+l.options.order/r)*frameRate,value:black});t.push({frame:82*frameRate-1,value:black});const o=82;for(let r=0;r<switchingColors.length;r++){let e=switchingColors[r].colors[l.options.order];if(l.options.suborder!==undefined){e=switchingColors[r].colors[l.options.order][l.options.suborder]}t.push({frame:(o+switchingColors[r].sec)*frameRate,value:e});if(switchingColors[r].smooth==false&&switchingColors[r+1]){t.push({frame:(o+switchingColors[r+1].sec)*frameRate-1,value:e})}}t.push({frame:125*frameRate,value:black});t.push({frame:130*frameRate,value:black});e.setKeys(t);return e};const stackLanterns=r=>{let l=0;for(let e=0;e<r.length;e++){const t=r[e].outerLayer.getBoundingInfo();l+=-t.minimum.y;r[e].outerLayer.position.y=l;l+=t.maximum.y}};const generateImage=(e,r,l,t,o,u,n)=>{const p=document.createElement("canvas");p.width=r;p.height=l;ctx=p.getContext("2d");ctx.strokeStyle="white";ctx.lineWidth=16;ctx.beginPath();ctx.moveTo(t,0);ctx.lineTo(0,u);ctx.lineTo(0,n);ctx.lineTo(t,l);ctx.lineTo(o,l);ctx.lineTo(r,n);ctx.lineTo(r,u);ctx.lineTo(o,0);ctx.lineTo(t,0);ctx.fillStyle="red";ctx.moveTo(0,u);ctx.lineTo(r,u);ctx.moveTo(0,n);ctx.lineTo(r,n);ctx.stroke();const a=p.toDataURL();return a};const downloadImage=(e,r)=>{const l=document.createElement("a");l.href=r;l.download=`${e}.png`;document.body.appendChild(l);l.click();document.body.removeChild(l)};const scene=createScene();engine.runRenderLoop(function(){scene.render()});window.addEventListener("resize",function(){engine.resize()});